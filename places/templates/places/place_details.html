{% extends "base.html" %}
{% load static %}


{% block content %}

<div class="border mx-5 rounded">
  <div class="card-header">
  	<div class="row">
  		<div class="col-10">
  			<h3> {{ place.name }} </h3>
  		</div>
  		<div class="col-2" id="favorite-section">
  			{% csrf_token %}
  			<form method="post" action="{% url 'manage_favorites' %}" class="fav-form">
				{% if place.is_favorite %}
				<button type="submit" class="btn"  id="{{place.id}}">
					<span name="fav" class="fas fa-heart fa-lg" id="{{place.id}}"></span>
				</button>	
				{% else %}
				<button type="submit" class="btn"  id={{place.id}}>
					<span name="fav" class="far fa-heart fa-lg" id="{{place.id}}"></span>
				</button>	
				{% endif %}				
			</form>				
  		</div>	
  	</div>
    
    <h5> {{ place.address }} </h5>
  </div>
  <div class="card-body">
	<div class="d-inline-flex mb-4">
  		{% if place.is_open %}
			<p class="card-text bg-success text-white rounded px-2">Ouvert</p>
		{% else %}
			<p class="card-text bg-danger text-white rounded px-2">Ferm√©</p>
		{% endif %}	
	</div>
	<p class="mb-4"> <i class="fas fa-phone-alt mr-3"></i> {{place.phone}} </p>
  </div>
  <div id="map" style=" height: 30rem; width: 30rem"></div>
</div>

<script lat="{{ place.coordonates.lat }}",
		lng="{{ place.coordonates.lng }}",
		my_lat="{{ my_lat }}",
		my_lng="{{ my_lng }}",
		id="map_script">
	let script = document.getElementById('map_script')
	let lat = parseFloat(script.getAttribute('lat'))
	let lng = parseFloat(script.getAttribute('lng'))
	let my_lat = parseFloat(script.getAttribute('my_lat'))
	let my_lng = parseFloat(script.getAttribute('my_lng'))

	function initMap(){
		var options = {
			zoom: 17,
			center:{lat:lat, lng:lng}
		}
		var map = new google.maps.Map(document.getElementById('map'), options)

		var my_marker = new google.maps.Marker({
			position: {lat: my_lat, lng: my_lng},
			map:map
		})
		var marker = new google.maps.Marker({
			position: {lat:lat, lng:lng},
			map:map
		})
	}
</script>
<script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCD7JddiwdM6f2evoQK8sr4KaUnWdL25z4&callback=initMap">
</script>


{% endblock %}